SLOWPOKE_POKER_BATCH_THRESHOLD_SOCIALGRAPH=100
SLOWPOKE_IS_TARGET_SERVICE_POSTSTORAGE=false
SLOWPOKE_POKER_BATCH_THRESHOLD_HOMETIMELINE=100
SLOWPOKE_IS_TARGET_SERVICE_USERTIMELINE=false
SLOWPOKE_PROCESSING_MICROS_USERTIMELINE=0
SLOWPOKE_IS_TARGET_SERVICE_SOCIALGRAPH=false
SLOWPOKE_DELAY_MICROS_SOCIALGRAPH=0.0
SLOWPOKE_IS_TARGET_SERVICE_HOMETIMELINE=true
SLOWPOKE_POKER_BATCH_THRESHOLD_POSTSTORAGE=100
SLOWPOKE_PROCESSING_MICROS_SOCIALGRAPH=0
SLOWPOKE_DELAY_MICROS_COMPOSEPOST=0.0
SLOWPOKE_PROCESSING_MICROS_HOMETIMELINE=1000
SLOWPOKE_DELAY_MICROS_USERTIMELINE=0.0
SLOWPOKE_IS_TARGET_SERVICE_COMPOSEPOST=false
SLOWPOKE_DELAY_MICROS_HOMETIMELINE=0.0
SLOWPOKE_PROCESSING_MICROS_POSTSTORAGE=0
SLOWPOKE_POKER_BATCH_THRESHOLD_COMPOSEPOST=100
SLOWPOKE_PROCESSING_MICROS_COMPOSEPOST=0
SLOWPOKE_DELAY_MICROS_POSTSTORAGE=0.0
SLOWPOKE_POKER_BATCH_THRESHOLD_USERTIMELINE=100
[run.sh] Running benchmark social with request mix, thread 8, conn 1024, duration 60
[run.sh] Deleting all services
service "composepost" deleted
deployment.apps "composepost" deleted
service "hometimeline" deleted
deployment.apps "hometimeline" deleted
service "poststorage" deleted
deployment.apps "poststorage" deleted
service "socialgraph" deleted
deployment.apps "socialgraph" deleted
service "usertimeline" deleted
deployment.apps "usertimeline" deleted
deployment.apps "ubuntu-client" deleted
[run.sh] Waiting for all pods to be deleted
[run.sh] Deploying all services
service/composepost created
deployment.apps/composepost created
service/hometimeline created
deployment.apps/hometimeline created
service/poststorage created
deployment.apps/poststorage created
service/socialgraph created
deployment.apps/socialgraph created
service/usertimeline created
deployment.apps/usertimeline created
[run.sh] Client pod not found, deploying client
deployment.apps/ubuntu-client created
[run.sh] Waiting for all pods to be running
[run.sh] All pods are running
[run.sh] Checking heartbeat for all services
[run.sh] All pods can connect to all services
[run.sh] Populating social benchmark
Parsing social graph file: ./data/socfb-Reed98.mtx... DONE!
Analyzing social graph in: ./data/analysis.txt... DONE!
Populating social graph... 
DONE!
[run.sh] Copying social/analysis.txt to ubuntu-client-76886f6bbd-ql2zr:/analysis.txt
[run.sh] Finished populating social
[run.sh] Starting the rust proxy first for social
[2m2025-04-15T23:33:07.529052Z[0m [32m INFO[0m [2mproxy::social[0m[2m:[0m Reading social graph from /analysis.txt
[run.sh] Running warmup test
[run.sh] /wrk/wrk -t8 -c1024 --timeout 3s -d3s -L http://localhost:3000
Running 3s test @ http://localhost:3000
  8 threads and 1024 connections
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency   246.04ms  277.00ms   1.91s    85.30%
    Req/Sec   378.90    177.62     1.00k    65.69%
  Latency Distribution
     50%  163.65ms
     75%  439.90ms
     90%  572.65ms
     99%    1.31s 
  9046 requests in 3.03s, 689.05KB read
Requests/sec:   2983.65
Transfer/sec:    227.27KB
[run.sh] Speed is 2983.65, duration is 10
[run.sh] Fix the request number.
[run.sh] Running the actual test
[run.sh] /wrk/wrk --timeout 20s -t8 -c1024 -d10s -s /wrk/fix_req_n.lua -L http://localhost:3000
Running 10s test @ http://localhost:3000
  8 threads and 1024 connections
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency   281.59ms  269.80ms   1.14s    47.21%
    Req/Sec   410.58    183.91     1.71k    74.69%
  Latency Distribution
     50%  252.68ms
     75%  529.75ms
     90%  602.10ms
     99%  831.56ms
  20000 requests in 10.00s, 1.49MB read
Requests/sec:   1999.97
Transfer/sec:    152.34KB
------------------------------
stop time: 5.692586
stop time: 5.676912
stop time: 5.817687
stop time: 6.088855
stop time: 6.156901
stop time: 6.423182
stop time: 6.455162
stop time: 6.502598
[run.sh] Checking the resource usage
NAME                             CPU(cores)   MEMORY(bytes)   
composepost-7db6769456-frsrb     77m          11Mi            
hometimeline-79bbcdf9d-cm2vd     153m         82Mi            
poststorage-846449c5c5-9gxfb     227m         23Mi            
socialgraph-8fdd4b78-nzgjm       20m          10Mi            
ubuntu-client-76886f6bbd-ql2zr   7m           70Mi            
usertimeline-57d9cfd884-92qwj    121m         13Mi            
[run.sh] Test finished with status 0
NAME                             READY   STATUS    RESTARTS   AGE   IP            NODE            NOMINATED NODE   READINESS GATES
composepost-7db6769456-frsrb     1/1     Running   0          60s   10.35.0.1     worker-4cpu-1   <none>           <none>
hometimeline-79bbcdf9d-cm2vd     1/1     Running   0          60s   10.37.0.1     worker-4cpu     <none>           <none>
poststorage-846449c5c5-9gxfb     1/1     Running   0          59s   10.34.128.1   worker-4cpu-3   <none>           <none>
socialgraph-8fdd4b78-nzgjm       1/1     Running   0          59s   10.46.128.1   worker-4cpu-4   <none>           <none>
ubuntu-client-76886f6bbd-ql2zr   1/1     Running   0          59s   10.44.0.2     worker0         <none>           <none>
usertimeline-57d9cfd884-92qwj    1/1     Running   0          59s   10.33.0.1     worker-4cpu-2   <none>           <none>
