cd $(dirname $0)

export SLOWPOKE_PROCESSING_MICROS_COMPOSEPOST=0
export SLOWPOKE_PROCESSING_MICROS_HOMETIMELINE=1000
export SLOWPOKE_PROCESSING_MICROS_POSTSTORAGE=0
export SLOWPOKE_PROCESSING_MICROS_SOCIALGRAPH=0
export SLOWPOKE_PROCESSING_MICROS_USERTIMELINE=0
export SLOWPOKE_DELAY_MICROS_COMPOSEPOST=0.0
export SLOWPOKE_POKER_BATCH_THRESHOLD_COMPOSEPOST=100
export SLOWPOKE_IS_TARGET_SERVICE_COMPOSEPOST=false
export SLOWPOKE_DELAY_MICROS_HOMETIMELINE=0.0
export SLOWPOKE_POKER_BATCH_THRESHOLD_HOMETIMELINE=100
export SLOWPOKE_IS_TARGET_SERVICE_HOMETIMELINE=true
export SLOWPOKE_DELAY_MICROS_POSTSTORAGE=0.0
export SLOWPOKE_POKER_BATCH_THRESHOLD_POSTSTORAGE=100
export SLOWPOKE_IS_TARGET_SERVICE_POSTSTORAGE=false
export SLOWPOKE_DELAY_MICROS_SOCIALGRAPH=0.0
export SLOWPOKE_POKER_BATCH_THRESHOLD_SOCIALGRAPH=100
export SLOWPOKE_IS_TARGET_SERVICE_SOCIALGRAPH=false
export SLOWPOKE_DELAY_MICROS_USERTIMELINE=0.0
export SLOWPOKE_POKER_BATCH_THRESHOLD_USERTIMELINE=100
export SLOWPOKE_IS_TARGET_SERVICE_USERTIMELINE=false

DIR=/home/ubuntu/mucache/slowpoke/social-real-opt/results
for i in $(seq 1 10); do
    FILE=premesaurement-$i.log
    if [ ! -d "$DIR" ]; then
    mkdir -p $DIR
    fi
    if [ -f "$DIR/$FILE" ]; then
    echo "$DIR/$FILE exists."
    continue
    fi
    env | grep SLOWPOKE > $DIR/$FILE
    bash /home/ubuntu/mucache/slowpoke/run.sh social mix 8 1024 20000 >> $DIR/$FILE
    kubectl get pods -o wide >> $DIR/$FILE
done