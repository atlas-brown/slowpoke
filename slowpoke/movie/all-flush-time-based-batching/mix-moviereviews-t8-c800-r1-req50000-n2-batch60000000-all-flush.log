benchmark                        : movie
num_threads                      : 8
num_conns                        : 800
target_service                   : moviereviews
request_type                     : mix
repetitions                      : 1
target_num_exp                   : 2
pre_run                          : False
num_req                          : 50000
groundtruths                     : []
slowdowns                        : []
predicteds                       : []
errs                             : []
client_cpu_quota                 : 4
random_seed                      : 1234
request_ratio                    : {'castinfo': 0.9050900514, 'composereview': 0.1003336848, 'frontend': 0.1003336848, 'movieid': 0.1003336848, 'movieinfo': 0.9050900514, 'moviereviews': 0.9050900514, 'page': 0.9050900514, 'plot': 0.9050900514, 'reviewstorage': 1.005423736183, 'uniqueid': 0.1003336848, 'user': 0.2006673695, 'userreviews': 0.1003336848}
baseline_service_processing_time : {'castinfo': 0, 'composereview': 0, 'frontend': 0, 'movieid': 0, 'movieinfo': 0, 'moviereviews': 1000, 'page': 0, 'plot': 0, 'reviewstorage': 0, 'uniqueid': 0, 'user': 0, 'userreviews': 0}
cpu_quota                        : {'castinfo': 2, 'composereview': 2, 'frontend': 2, 'movieid': 2, 'movieinfo': 2, 'moviereviews': 2, 'page': 2, 'plot': 2, 'reviewstorage': 2, 'uniqueid': 2, 'user': 2, 'userreviews': 2}
target_processing_time_range     : [0, 1000]
baseline_throughputs             : []
poker_batch                      : 60000000
[test.py] Starting experiment...
[test.py] >>>>>>>>>>>>>>>>>>>>>>>>>>>>> Running experiment 0...
[test.py] Actual processing time range: [0, 500]
[test.py] Running baseline experiment
    [exp] Running (pre_run: False) workload movie/mix request with the following configuration: {'CLIENT_CPU_QUOTA': '4', 'SLOWPOKE_POKER_BATCH_THRESHOLD': '60000000', 'SLOWPOKE_PROCESSING_MICROS_CASTINFO': '0', 'SLOWPOKE_PROCESSING_MICROS_COMPOSEREVIEW': '0', 'SLOWPOKE_PROCESSING_MICROS_FRONTEND': '0', 'SLOWPOKE_PROCESSING_MICROS_MOVIEID': '0', 'SLOWPOKE_PROCESSING_MICROS_MOVIEINFO': '0', 'SLOWPOKE_PROCESSING_MICROS_MOVIEREVIEWS': '1000', 'SLOWPOKE_PROCESSING_MICROS_PAGE': '0', 'SLOWPOKE_PROCESSING_MICROS_PLOT': '0', 'SLOWPOKE_PROCESSING_MICROS_REVIEWSTORAGE': '0', 'SLOWPOKE_PROCESSING_MICROS_UNIQUEID': '0', 'SLOWPOKE_PROCESSING_MICROS_USER': '0', 'SLOWPOKE_PROCESSING_MICROS_USERREVIEWS': '0', 'SLOWPOKE_DELAY_MICROS_CASTINFO': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_CASTINFO': '10', 'SLOWPOKE_DELAY_MICROS_COMPOSEREVIEW': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_COMPOSEREVIEW': '10', 'SLOWPOKE_DELAY_MICROS_FRONTEND': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_FRONTEND': '10', 'SLOWPOKE_DELAY_MICROS_MOVIEID': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_MOVIEID': '10', 'SLOWPOKE_DELAY_MICROS_MOVIEINFO': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_MOVIEINFO': '10', 'SLOWPOKE_DELAY_MICROS_MOVIEREVIEWS': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_MOVIEREVIEWS': '10', 'SLOWPOKE_DELAY_MICROS_PAGE': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_PAGE': '10', 'SLOWPOKE_DELAY_MICROS_PLOT': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_PLOT': '10', 'SLOWPOKE_DELAY_MICROS_REVIEWSTORAGE': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_REVIEWSTORAGE': '10', 'SLOWPOKE_DELAY_MICROS_UNIQUEID': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_UNIQUEID': '10', 'SLOWPOKE_DELAY_MICROS_USER': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_USER': '10', 'SLOWPOKE_DELAY_MICROS_USERREVIEWS': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_USERREVIEWS': '10'}
    [exp] Executing cmd `bash run.sh movie mix 8 800 50000`:
        [run.sh] Running benchmark movie with request mix, thread 8, conn 800, duration 60
        [run.sh] Deleting all services
        [run.sh] Waiting for all pods to be deleted
        [run.sh] Deploying all services
        service/castinfo created
        deployment.apps/castinfo created
        service/composereview created
        deployment.apps/composereview created
        service/frontend created
        deployment.apps/frontend created
        service/movieid created
        deployment.apps/movieid created
        service/movieinfo created
        deployment.apps/movieinfo created
        service/moviereviews created
        deployment.apps/moviereviews created
        service/page created
        deployment.apps/page created
        service/plot created
        deployment.apps/plot created
        service/reviewstorage created
        deployment.apps/reviewstorage created
        service/uniqueid created
        deployment.apps/uniqueid created
        service/user created
        deployment.apps/user created
        service/userreviews created
        deployment.apps/userreviews created
        [run.sh] Client pod not found, deploying client
        deployment.apps/ubuntu-client created
        [run.sh] Waiting for all pods to be running
        [run.sh] All pods are running
        [run.sh] Checking heartbeat for all services
        [run.sh] All pods can connect to all services
        [run.sh] Copying movie/analysis.txt to ubuntu-client-76886f6bbd-8mnxd:/analysis.txt
        [run.sh] Finished populating movie
        [run.sh] Starting the rust proxy first for movie
        [2m2025-04-06T00:35:59.952074Z[0m [32m INFO[0m [2mproxy::movie[0m[2m:[0m Reading movie analysis data from /analysis.txt
        [run.sh] Running warmup test
        [run.sh] /wrk/wrk -t8 -c800 -d3s -L http://localhost:3000
        Running 3s test @ http://localhost:3000
        8 threads and 800 connections
        Thread Stats   Avg      Stdev     Max   +/- Stdev
        Latency   514.45ms  205.98ms   1.03s    77.37%
        Req/Sec   169.00     60.10   323.00     74.44%
        Latency Distribution
        50%  547.96ms
        75%  641.45ms
        90%  724.42ms
        99%  889.30ms
        3814 requests in 3.03s, 290.52KB read
        Requests/sec:   1260.81
        Transfer/sec:     96.04KB
        [run.sh] Speed is 1260.81, duration is 79
        [run.sh] Fix the request number.
        [run.sh] Running the actual test
        [run.sh] /wrk/wrk --timeout 20s -t8 -c800 -d79s -s /wrk/fix_req_n.lua -L http://localhost:3000
        [run.sh] Checking the resource usage
        NAME                             CPU(cores)   MEMORY(bytes)
        castinfo-56549f7689-qw2qs        126m         151Mi
        composereview-676886854c-jhvcm   102m         9Mi
        frontend-67bcc5d87b-86jn9        44m          10Mi
        movieid-6b7485b65-rpblp          11m          178Mi
        movieinfo-969fd9977-6pkll        33m          200Mi
        moviereviews-7d747bcb8-7s2jh     593m         20Mi
        page-6597cb4c54-llk7c            49m          86Mi
        plot-5464fccfdd-csjcj            100m         292Mi
        reviewstorage-86dd5ff9b9-52gf5   22m          11Mi
        ubuntu-client-76886f6bbd-8mnxd   236m         78Mi
        uniqueid-5987bc8cf9-pfrql        14m          7Mi
        user-6776c48774-84wjg            21m          7Mi
        userreviews-5d99989bf-bc2kp      12m          7Mi
        Running 1m test @ http://localhost:3000
        8 threads and 800 connections
        Thread Stats   Avg      Stdev     Max   +/- Stdev
        Latency     1.62s     2.75s   19.65s    88.56%
        Req/Sec   178.97     56.33   414.00     70.54%
        Latency Distribution
        50%  610.81ms
        75%  743.29ms
        90%    4.90s
        99%   13.62s
        50000 requests in 1.32m, 3.72MB read
        Socket errors: connect 0, read 0, write 0, timeout 3
        Requests/sec:    632.91
        Transfer/sec:     48.21KB
        ------------------------------
        stop time: 52.821907
        stop time: 52.940617
        stop time: 52.944496
        stop time: 52.862121
        stop time: 53.282379
        stop time: 53.161411
        stop time: 53.118755
        stop time: 52.871122
        [run.sh] Test finished with status 0
        > STDERR
        > No resources found in default namespace.
    [exp] Times: [52.821907, 52.940617, 52.944496, 52.862121, 53.282379, 53.161411, 53.118755, 52.871122]
    [exp] Throughput: 943.3899786814619
[test.py] Baseline throughput: 943.3899786814619
[test.py] Running groundtruth experiment
    [exp] Running (pre_run: False) workload movie/mix request with the following configuration: {'CLIENT_CPU_QUOTA': '4', 'SLOWPOKE_POKER_BATCH_THRESHOLD': '60000000', 'SLOWPOKE_PROCESSING_MICROS_CASTINFO': '0', 'SLOWPOKE_PROCESSING_MICROS_COMPOSEREVIEW': '0', 'SLOWPOKE_PROCESSING_MICROS_FRONTEND': '0', 'SLOWPOKE_PROCESSING_MICROS_MOVIEID': '0', 'SLOWPOKE_PROCESSING_MICROS_MOVIEINFO': '0', 'SLOWPOKE_PROCESSING_MICROS_MOVIEREVIEWS': '0', 'SLOWPOKE_PROCESSING_MICROS_PAGE': '0', 'SLOWPOKE_PROCESSING_MICROS_PLOT': '0', 'SLOWPOKE_PROCESSING_MICROS_REVIEWSTORAGE': '0', 'SLOWPOKE_PROCESSING_MICROS_UNIQUEID': '0', 'SLOWPOKE_PROCESSING_MICROS_USER': '0', 'SLOWPOKE_PROCESSING_MICROS_USERREVIEWS': '0', 'SLOWPOKE_DELAY_MICROS_CASTINFO': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_CASTINFO': '10', 'SLOWPOKE_DELAY_MICROS_COMPOSEREVIEW': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_COMPOSEREVIEW': '10', 'SLOWPOKE_DELAY_MICROS_FRONTEND': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_FRONTEND': '10', 'SLOWPOKE_DELAY_MICROS_MOVIEID': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_MOVIEID': '10', 'SLOWPOKE_DELAY_MICROS_MOVIEINFO': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_MOVIEINFO': '10', 'SLOWPOKE_DELAY_MICROS_MOVIEREVIEWS': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_MOVIEREVIEWS': '10', 'SLOWPOKE_DELAY_MICROS_PAGE': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_PAGE': '10', 'SLOWPOKE_DELAY_MICROS_PLOT': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_PLOT': '10', 'SLOWPOKE_DELAY_MICROS_REVIEWSTORAGE': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_REVIEWSTORAGE': '10', 'SLOWPOKE_DELAY_MICROS_UNIQUEID': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_UNIQUEID': '10', 'SLOWPOKE_DELAY_MICROS_USER': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_USER': '10', 'SLOWPOKE_DELAY_MICROS_USERREVIEWS': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_USERREVIEWS': '10'}
    [exp] Executing cmd `bash run.sh movie mix 8 800 50000`:
        [run.sh] Running benchmark movie with request mix, thread 8, conn 800, duration 60
        [run.sh] Deleting all services
        service "castinfo" deleted
        deployment.apps "castinfo" deleted
        service "composereview" deleted
        deployment.apps "composereview" deleted
        service "frontend" deleted
        deployment.apps "frontend" deleted
        service "movieid" deleted
        deployment.apps "movieid" deleted
        service "movieinfo" deleted
        deployment.apps "movieinfo" deleted
        service "moviereviews" deleted
        deployment.apps "moviereviews" deleted
        service "page" deleted
        deployment.apps "page" deleted
        service "plot" deleted
        deployment.apps "plot" deleted
        service "reviewstorage" deleted
        deployment.apps "reviewstorage" deleted
        service "uniqueid" deleted
        deployment.apps "uniqueid" deleted
        service "user" deleted
        deployment.apps "user" deleted
        service "userreviews" deleted
        deployment.apps "userreviews" deleted
        deployment.apps "ubuntu-client" deleted
        [run.sh] Waiting for all pods to be deleted
