benchmark                        : movie
num_threads                      : 8
num_conns                        : 800
target_service                   : moviereviews
request_type                     : mix
repetitions                      : 1
target_num_exp                   : 2
pre_run                          : False
num_req                          : 50000
groundtruths                     : []
slowdowns                        : []
predicteds                       : []
errs                             : []
client_cpu_quota                 : 4
random_seed                      : 1234
request_ratio                    : {'castinfo': 0.9050900514, 'composereview': 0.1003336848, 'frontend': 0.1003336848, 'movieid': 0.1003336848, 'movieinfo': 0.9050900514, 'moviereviews': 0.9050900514, 'page': 0.9050900514, 'plot': 0.9050900514, 'reviewstorage': 1.005423736183, 'uniqueid': 0.1003336848, 'user': 0.2006673695, 'userreviews': 0.1003336848}
baseline_service_processing_time : {'castinfo': 0, 'composereview': 0, 'frontend': 0, 'movieid': 0, 'movieinfo': 0, 'moviereviews': 1000, 'page': 0, 'plot': 0, 'reviewstorage': 0, 'uniqueid': 0, 'user': 0, 'userreviews': 0}
cpu_quota                        : {'castinfo': 2, 'composereview': 2, 'frontend': 2, 'movieid': 2, 'movieinfo': 2, 'moviereviews': 2, 'page': 2, 'plot': 2, 'reviewstorage': 2, 'uniqueid': 2, 'user': 2, 'userreviews': 2}
target_processing_time_range     : [0, 1000]
baseline_throughputs             : []
poker_batch                      : 60000000
[test.py] Starting experiment...
[test.py] >>>>>>>>>>>>>>>>>>>>>>>>>>>>> Running experiment 0...
[test.py] Actual processing time range: [0, 500]
[test.py] Running baseline experiment
    [exp] Running (pre_run: False) workload movie/mix request with the following configuration: {'CLIENT_CPU_QUOTA': '4', 'SLOWPOKE_POKER_BATCH_THRESHOLD': '60000000', 'SLOWPOKE_PROCESSING_MICROS_CASTINFO': '0', 'SLOWPOKE_PROCESSING_MICROS_COMPOSEREVIEW': '0', 'SLOWPOKE_PROCESSING_MICROS_FRONTEND': '0', 'SLOWPOKE_PROCESSING_MICROS_MOVIEID': '0', 'SLOWPOKE_PROCESSING_MICROS_MOVIEINFO': '0', 'SLOWPOKE_PROCESSING_MICROS_MOVIEREVIEWS': '1000', 'SLOWPOKE_PROCESSING_MICROS_PAGE': '0', 'SLOWPOKE_PROCESSING_MICROS_PLOT': '0', 'SLOWPOKE_PROCESSING_MICROS_REVIEWSTORAGE': '0', 'SLOWPOKE_PROCESSING_MICROS_UNIQUEID': '0', 'SLOWPOKE_PROCESSING_MICROS_USER': '0', 'SLOWPOKE_PROCESSING_MICROS_USERREVIEWS': '0', 'SLOWPOKE_DELAY_MICROS_CASTINFO': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_CASTINFO': '10', 'SLOWPOKE_DELAY_MICROS_COMPOSEREVIEW': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_COMPOSEREVIEW': '10', 'SLOWPOKE_DELAY_MICROS_FRONTEND': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_FRONTEND': '10', 'SLOWPOKE_DELAY_MICROS_MOVIEID': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_MOVIEID': '10', 'SLOWPOKE_DELAY_MICROS_MOVIEINFO': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_MOVIEINFO': '10', 'SLOWPOKE_DELAY_MICROS_MOVIEREVIEWS': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_MOVIEREVIEWS': '10', 'SLOWPOKE_DELAY_MICROS_PAGE': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_PAGE': '10', 'SLOWPOKE_DELAY_MICROS_PLOT': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_PLOT': '10', 'SLOWPOKE_DELAY_MICROS_REVIEWSTORAGE': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_REVIEWSTORAGE': '10', 'SLOWPOKE_DELAY_MICROS_UNIQUEID': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_UNIQUEID': '10', 'SLOWPOKE_DELAY_MICROS_USER': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_USER': '10', 'SLOWPOKE_DELAY_MICROS_USERREVIEWS': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_USERREVIEWS': '10'}
    [exp] Executing cmd `bash run.sh movie mix 8 800 50000`:
        [run.sh] Running benchmark movie with request mix, thread 8, conn 800, duration 60
        [run.sh] Deleting all services
        [run.sh] Waiting for all pods to be deleted
        [run.sh] Deploying all services
        service/castinfo created
        deployment.apps/castinfo created
        service/composereview created
        deployment.apps/composereview created
        service/frontend created
        deployment.apps/frontend created
        service/movieid created
        deployment.apps/movieid created
        service/movieinfo created
        deployment.apps/movieinfo created
        service/moviereviews created
        deployment.apps/moviereviews created
        service/page created
        deployment.apps/page created
        service/plot created
        deployment.apps/plot created
        service/reviewstorage created
        deployment.apps/reviewstorage created
        service/uniqueid created
        deployment.apps/uniqueid created
        service/user created
        deployment.apps/user created
        service/userreviews created
        deployment.apps/userreviews created
        [run.sh] Client pod not found, deploying client
        deployment.apps/ubuntu-client created
        [run.sh] Waiting for all pods to be running
        [run.sh] All pods are running
        [run.sh] Checking heartbeat for all services
        [run.sh] All pods can connect to all services
        [run.sh] Copying movie/analysis.txt to ubuntu-client-76886f6bbd-b4lkp:/analysis.txt
        [run.sh] Finished populating movie
        [run.sh] Starting the rust proxy first for movie
        [2m2025-04-06T00:32:12.363857Z[0m [32m INFO[0m [2mproxy::movie[0m[2m:[0m Reading movie analysis data from /analysis.txt
        [run.sh] Running warmup test
        [run.sh] /wrk/wrk -t8 -c800 -d3s -L http://localhost:3000
        Running 3s test @ http://localhost:3000
        8 threads and 800 connections
        Thread Stats   Avg      Stdev     Max   +/- Stdev
        Latency   466.22ms  193.93ms 931.73ms   75.44%
        Req/Sec   182.94     61.74   360.00     72.00%
        Latency Distribution
        50%  495.02ms
        75%  588.09ms
        90%  675.34ms
        99%  813.06ms
        4194 requests in 3.03s, 319.46KB read
        Requests/sec:   1386.30
        Transfer/sec:    105.60KB
        [run.sh] Speed is 1386.30, duration is 72
        [run.sh] Fix the request number.
        [run.sh] Running the actual test
        [run.sh] /wrk/wrk --timeout 20s -t8 -c800 -d72s -s /wrk/fix_req_n.lua -L http://localhost:3000
        [run.sh] Checking the resource usage
        NAME                             CPU(cores)   MEMORY(bytes)
        castinfo-56549f7689-66q7d        1m           150Mi
        composereview-676886854c-jqr7m   1m           14Mi
        frontend-67bcc5d87b-nzml2        28m          13Mi
        movieid-6b7485b65-rch6q          7m           172Mi
        movieinfo-969fd9977-8bc4b        1m           190Mi
        moviereviews-7d747bcb8-c8tx5     1m           21Mi
        page-6597cb4c54-jng7w            0m           87Mi
        plot-5464fccfdd-c7qqs            1m           287Mi
        reviewstorage-86dd5ff9b9-r2qh8   1m           12Mi
        ubuntu-client-76886f6bbd-b4lkp   174m         71Mi
        uniqueid-5987bc8cf9-pmbpp        7m           7Mi
        user-6776c48774-pwv5t            7m           7Mi
        userreviews-5d99989bf-9vbkh      6m           6Mi
        Running 1m test @ http://localhost:3000
        8 threads and 800 connections
        Thread Stats   Avg      Stdev     Max   +/- Stdev
        Latency   495.54ms  169.68ms   1.07s    84.02%
        Req/Sec   201.01     50.28   430.00     70.17%
        Latency Distribution
        50%  531.51ms
        75%  576.70ms
        90%  630.59ms
        99%  751.10ms
        50001 requests in 1.20m, 3.72MB read
        Requests/sec:    694.46
        Transfer/sec:     52.90KB
        ------------------------------
        stop time: 30.971527
        stop time: 31.276903
        stop time: 31.278757
        stop time: 31.111104
        stop time: 31.612549
        stop time: 31.391378
        stop time: 31.185743
        stop time: 31.234469
        [run.sh] Test finished with status 0
        > STDERR
        > No resources found in default namespace.
    [exp] Times: [30.971527, 31.276903, 31.278757, 31.111104, 31.612549, 31.391378, 31.185743, 31.234469]
    [exp] Throughput: 1599.6005477512158
[test.py] Baseline throughput: 1599.6005477512158
[test.py] Running groundtruth experiment
    [exp] Running (pre_run: False) workload movie/mix request with the following configuration: {'CLIENT_CPU_QUOTA': '4', 'SLOWPOKE_POKER_BATCH_THRESHOLD': '60000000', 'SLOWPOKE_PROCESSING_MICROS_CASTINFO': '0', 'SLOWPOKE_PROCESSING_MICROS_COMPOSEREVIEW': '0', 'SLOWPOKE_PROCESSING_MICROS_FRONTEND': '0', 'SLOWPOKE_PROCESSING_MICROS_MOVIEID': '0', 'SLOWPOKE_PROCESSING_MICROS_MOVIEINFO': '0', 'SLOWPOKE_PROCESSING_MICROS_MOVIEREVIEWS': '0', 'SLOWPOKE_PROCESSING_MICROS_PAGE': '0', 'SLOWPOKE_PROCESSING_MICROS_PLOT': '0', 'SLOWPOKE_PROCESSING_MICROS_REVIEWSTORAGE': '0', 'SLOWPOKE_PROCESSING_MICROS_UNIQUEID': '0', 'SLOWPOKE_PROCESSING_MICROS_USER': '0', 'SLOWPOKE_PROCESSING_MICROS_USERREVIEWS': '0', 'SLOWPOKE_DELAY_MICROS_CASTINFO': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_CASTINFO': '10', 'SLOWPOKE_DELAY_MICROS_COMPOSEREVIEW': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_COMPOSEREVIEW': '10', 'SLOWPOKE_DELAY_MICROS_FRONTEND': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_FRONTEND': '10', 'SLOWPOKE_DELAY_MICROS_MOVIEID': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_MOVIEID': '10', 'SLOWPOKE_DELAY_MICROS_MOVIEINFO': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_MOVIEINFO': '10', 'SLOWPOKE_DELAY_MICROS_MOVIEREVIEWS': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_MOVIEREVIEWS': '10', 'SLOWPOKE_DELAY_MICROS_PAGE': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_PAGE': '10', 'SLOWPOKE_DELAY_MICROS_PLOT': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_PLOT': '10', 'SLOWPOKE_DELAY_MICROS_REVIEWSTORAGE': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_REVIEWSTORAGE': '10', 'SLOWPOKE_DELAY_MICROS_UNIQUEID': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_UNIQUEID': '10', 'SLOWPOKE_DELAY_MICROS_USER': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_USER': '10', 'SLOWPOKE_DELAY_MICROS_USERREVIEWS': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_USERREVIEWS': '10'}
    [exp] Executing cmd `bash run.sh movie mix 8 800 50000`:
        [run.sh] Running benchmark movie with request mix, thread 8, conn 800, duration 60
        [run.sh] Deleting all services
        service "castinfo" deleted
        deployment.apps "castinfo" deleted
        service "composereview" deleted
        deployment.apps "composereview" deleted
        service "frontend" deleted
        deployment.apps "frontend" deleted
        service "movieid" deleted
        deployment.apps "movieid" deleted
        service "movieinfo" deleted
        deployment.apps "movieinfo" deleted
        service "moviereviews" deleted
        deployment.apps "moviereviews" deleted
        service "page" deleted
        deployment.apps "page" deleted
        service "plot" deleted
        deployment.apps "plot" deleted
        service "reviewstorage" deleted
        deployment.apps "reviewstorage" deleted
        service "uniqueid" deleted
        deployment.apps "uniqueid" deleted
        service "user" deleted
        deployment.apps "user" deleted
        service "userreviews" deleted
        deployment.apps "userreviews" deleted
        deployment.apps "ubuntu-client" deleted
        [run.sh] Waiting for all pods to be deleted
