SLOWPOKE_PROCESSING_MICROS_MOVIEID=0
SLOWPOKE_DELAY_MICROS_MOVIEINFO=0
SLOWPOKE_DELAY_MICROS_REVIEWSTORAGE=0
SLOWPOKE_DELAY_MICROS_COMPOSEREVIEW=0
SLOWPOKE_DELAY_MICROS_PAGE=0
SLOWPOKE_POKER_BATCH_THRESHOLD=20000000
SLOWPOKE_PROCESSING_MICROS_PAGE=0
SLOWPOKE_PROCESSING_MICROS_PLOT=0
SLOWPOKE_DELAY_MICROS_PLOT=0
SLOWPOKE_PROCESSING_MICROS_FRONTEND=0
SLOWPOKE_DELAY_MICROS_MOVIEREVIEWS=0
SLOWPOKE_DELAY_MICROS_MOVIEID=0
SLOWPOKE_PRERUN=false
SLOWPOKE_PROCESSING_MICROS_COMPOSEREVIEW=0
SLOWPOKE_DELAY_MICROS_UNIQUEID=0
SLOWPOKE_PROCESSING_MICROS_MOVIEINFO=0
SLOWPOKE_DELAY_MICROS_CASTINFO=0
SLOWPOKE_PROCESSING_MICROS_USERREVIEWS=0
SLOWPOKE_DELAY_MICROS_USER=0
SLOWPOKE_DELAY_MICROS_USERREVIEWS=0
SLOWPOKE_PROCESSING_MICROS_MOVIEREVIEWS=0
SLOWPOKE_PROCESSING_MICROS_USER=0
SLOWPOKE_PROCESSING_MICROS_REVIEWSTORAGE=0
SLOWPOKE_DELAY_MICROS_FRONTEND=0
SLOWPOKE_PROCESSING_MICROS_UNIQUEID=0
SLOWPOKE_PROCESSING_MICROS_CASTINFO=0
SLOWPOKE_PROCESSING_MICROS_MOVIEID=0
SLOWPOKE_PROCESSING_MICROS_PAGE=0
SLOWPOKE_PROCESSING_MICROS_PLOT=0
SLOWPOKE_PROCESSING_MICROS_FRONTEND=0
SLOWPOKE_PROCESSING_MICROS_COMPOSEREVIEW=0
SLOWPOKE_PROCESSING_MICROS_MOVIEINFO=0
SLOWPOKE_PROCESSING_MICROS_USERREVIEWS=0
SLOWPOKE_PROCESSING_MICROS_MOVIEREVIEWS=0
SLOWPOKE_PROCESSING_MICROS_USER=0
SLOWPOKE_PROCESSING_MICROS_REVIEWSTORAGE=0
SLOWPOKE_PROCESSING_MICROS_UNIQUEID=0
SLOWPOKE_PROCESSING_MICROS_CASTINFO=0
bash run.sh movie mix 8 512 50000
[run.sh] Running benchmark movie with request mix, thread 8, conn 512, duration 60
[run.sh] Deleting all services
service "castinfo" deleted
deployment.apps "castinfo" deleted
service "composereview" deleted
deployment.apps "composereview" deleted
service "frontend" deleted
deployment.apps "frontend" deleted
service "movieid" deleted
deployment.apps "movieid" deleted
service "movieinfo" deleted
deployment.apps "movieinfo" deleted
service "moviereviews" deleted
deployment.apps "moviereviews" deleted
service "page" deleted
deployment.apps "page" deleted
service "plot" deleted
deployment.apps "plot" deleted
service "reviewstorage" deleted
deployment.apps "reviewstorage" deleted
service "uniqueid" deleted
deployment.apps "uniqueid" deleted
service "user" deleted
deployment.apps "user" deleted
service "userreviews" deleted
deployment.apps "userreviews" deleted
deployment.apps "ubuntu-client" deleted
[run.sh] Waiting for all pods to be deleted
[run.sh] Deploying all services
service/castinfo created
deployment.apps/castinfo created
service/composereview created
deployment.apps/composereview created
service/frontend created
deployment.apps/frontend created
service/movieid created
deployment.apps/movieid created
service/movieinfo created
deployment.apps/movieinfo created
service/moviereviews created
deployment.apps/moviereviews created
service/page created
deployment.apps/page created
service/plot created
deployment.apps/plot created
service/reviewstorage created
deployment.apps/reviewstorage created
service/uniqueid created
deployment.apps/uniqueid created
service/user created
deployment.apps/user created
service/userreviews created
deployment.apps/userreviews created
[run.sh] Client pod not found, deploying client
deployment.apps/ubuntu-client created
[run.sh] Waiting for all pods to be running
[run.sh] All pods are running
[run.sh] Checking heartbeat for all services
[run.sh] All pods can connect to all services
[run.sh] Copying movie/analysis.txt to ubuntu-client-76886f6bbd-swzcf:/analysis.txt
[run.sh] Finished populating movie
[run.sh] Starting the rust proxy first for movie
[2m2025-04-02T18:05:41.586535Z[0m [32m INFO[0m [2mproxy::movie[0m[2m:[0m Reading movie analysis data from /analysis.txt
[run.sh] Running warmup test
[run.sh] /wrk/wrk -t8 -c512 -d3s -L http://localhost:3000
Running 3s test @ http://localhost:3000
  8 threads and 512 connections
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency   293.88ms  141.96ms 791.07ms   72.23%
    Req/Sec   191.27     76.60   414.00     66.38%
  Latency Distribution
     50%  306.81ms
     75%  383.81ms
     90%  460.55ms
     99%  603.86ms
  4442 requests in 3.03s, 338.36KB read
Requests/sec:   1466.86
Transfer/sec:    111.73KB
[run.sh] Speed is 1466.86, duration is 51
[run.sh] Fix the request number.
[run.sh] Running the actual test
[run.sh] /wrk/wrk --timeout 20s -t8 -c512 -d51s -s /wrk/fix_req_n.lua -L http://localhost:3000
[run.sh] Checking the resource usage
NAME                             CPU(cores)   MEMORY(bytes)   
castinfo-b9d7f87c-wxnd5          141m         59Mi            
composereview-645d44d577-88c6l   39m          10Mi            
frontend-74f96d9f98-kbz4p        31m          10Mi            
movieid-74868df96c-bscjx         7m           172Mi           
movieinfo-67b7ffc985-8ww58       45m          195Mi           
moviereviews-5f698fc9b5-klrmm    152m         16Mi            
page-5849776c6d-2jbm9            595m         49Mi            
plot-56d6fb9dd-nfhwq             71m          306Mi           
reviewstorage-5d4f557649-cvq6l   64m          9Mi             
ubuntu-client-76886f6bbd-swzcf   186m         42Mi            
uniqueid-6966dd5cc5-zc9q2        8m           6Mi             
user-755957cdfd-qrv4l            15m          7Mi             
userreviews-768dc858bf-9tsbj     6m           6Mi             
Running 1m test @ http://localhost:3000
  8 threads and 512 connections
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency   557.72ms  816.66ms   5.45s    90.94%
    Req/Sec   203.70     81.54     0.94k    69.36%
  Latency Distribution
     50%  336.89ms
     75%  442.05ms
     90%    1.06s 
     99%    4.35s 
  50000 requests in 0.85m, 3.72MB read
Requests/sec:    980.39
Transfer/sec:     74.68KB
------------------------------
stop time: 36.730063
stop time: 37.070000
stop time: 36.779842
stop time: 37.048925
stop time: 37.288183
stop time: 36.951087
stop time: 37.117233
stop time: 37.339684
[run.sh] Test finished with status 0

50000 / ( ( 36.730063 + 37.070000 + 36.779842 + 37.048925 + 37.288183 + 36.951087 + 37.117233 + 37.339684 ) / 8 ) = 1,349.869153977