SLOWPOKE_PROCESSING_MICROS_MOVIEID=0
SLOWPOKE_DELAY_MICROS_MOVIEINFO=0
SLOWPOKE_DELAY_MICROS_REVIEWSTORAGE=0
SLOWPOKE_DELAY_MICROS_COMPOSEREVIEW=0
SLOWPOKE_DELAY_MICROS_PAGE=0
SLOWPOKE_POKER_BATCH_THRESHOLD=20000000
SLOWPOKE_PROCESSING_MICROS_PAGE=0
SLOWPOKE_PROCESSING_MICROS_PLOT=0
SLOWPOKE_DELAY_MICROS_PLOT=0
SLOWPOKE_PROCESSING_MICROS_FRONTEND=0
SLOWPOKE_DELAY_MICROS_MOVIEREVIEWS=0
SLOWPOKE_DELAY_MICROS_MOVIEID=0
SLOWPOKE_PRERUN=false
SLOWPOKE_PROCESSING_MICROS_COMPOSEREVIEW=0
SLOWPOKE_DELAY_MICROS_UNIQUEID=0
SLOWPOKE_PROCESSING_MICROS_MOVIEINFO=0
SLOWPOKE_DELAY_MICROS_CASTINFO=0
SLOWPOKE_PROCESSING_MICROS_USERREVIEWS=0
SLOWPOKE_DELAY_MICROS_USER=0
SLOWPOKE_DELAY_MICROS_USERREVIEWS=0
SLOWPOKE_PROCESSING_MICROS_MOVIEREVIEWS=500
SLOWPOKE_PROCESSING_MICROS_USER=0
SLOWPOKE_PROCESSING_MICROS_REVIEWSTORAGE=0
SLOWPOKE_DELAY_MICROS_FRONTEND=0
SLOWPOKE_PROCESSING_MICROS_UNIQUEID=0
SLOWPOKE_PROCESSING_MICROS_CASTINFO=0
SLOWPOKE_PROCESSING_MICROS_MOVIEID=0
SLOWPOKE_PROCESSING_MICROS_PAGE=0
SLOWPOKE_PROCESSING_MICROS_PLOT=0
SLOWPOKE_PROCESSING_MICROS_FRONTEND=0
SLOWPOKE_PROCESSING_MICROS_COMPOSEREVIEW=0
SLOWPOKE_PROCESSING_MICROS_MOVIEINFO=0
SLOWPOKE_PROCESSING_MICROS_USERREVIEWS=0
SLOWPOKE_PROCESSING_MICROS_MOVIEREVIEWS=500
SLOWPOKE_PROCESSING_MICROS_USER=0
SLOWPOKE_PROCESSING_MICROS_REVIEWSTORAGE=0
SLOWPOKE_PROCESSING_MICROS_UNIQUEID=0
SLOWPOKE_PROCESSING_MICROS_CASTINFO=0
bash run.sh movie mix 8 512 50000
[run.sh] Running benchmark movie with request mix, thread 8, conn 512, duration 60
[run.sh] Deleting all services
service "castinfo" deleted
deployment.apps "castinfo" deleted
service "composereview" deleted
deployment.apps "composereview" deleted
service "frontend" deleted
deployment.apps "frontend" deleted
service "movieid" deleted
deployment.apps "movieid" deleted
service "movieinfo" deleted
deployment.apps "movieinfo" deleted
service "moviereviews" deleted
deployment.apps "moviereviews" deleted
service "page" deleted
deployment.apps "page" deleted
service "plot" deleted
deployment.apps "plot" deleted
service "reviewstorage" deleted
deployment.apps "reviewstorage" deleted
service "uniqueid" deleted
deployment.apps "uniqueid" deleted
service "user" deleted
deployment.apps "user" deleted
service "userreviews" deleted
deployment.apps "userreviews" deleted
deployment.apps "ubuntu-client" deleted
[run.sh] Waiting for all pods to be deleted
[run.sh] Deploying all services
service/castinfo created
deployment.apps/castinfo created
service/composereview created
deployment.apps/composereview created
service/frontend created
deployment.apps/frontend created
service/movieid created
deployment.apps/movieid created
service/movieinfo created
deployment.apps/movieinfo created
service/moviereviews created
deployment.apps/moviereviews created
service/page created
deployment.apps/page created
service/plot created
deployment.apps/plot created
service/reviewstorage created
deployment.apps/reviewstorage created
service/uniqueid created
deployment.apps/uniqueid created
service/user created
deployment.apps/user created
service/userreviews created
deployment.apps/userreviews created
[run.sh] Client pod not found, deploying client
deployment.apps/ubuntu-client created
[run.sh] Waiting for all pods to be running
[run.sh] All pods are running
[run.sh] Checking heartbeat for all services
[run.sh] All pods can connect to all services
[run.sh] Copying movie/analysis.txt to ubuntu-client-76886f6bbd-wbt75:/analysis.txt
[run.sh] Finished populating movie
[run.sh] Starting the rust proxy first for movie
[2m2025-04-02T18:08:59.951570Z[0m [32m INFO[0m [2mproxy::movie[0m[2m:[0m Reading movie analysis data from /analysis.txt
[run.sh] Running warmup test
[run.sh] /wrk/wrk -t8 -c512 -d3s -L http://localhost:3000
Running 3s test @ http://localhost:3000
  8 threads and 512 connections
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency   285.37ms  140.19ms 880.66ms   72.24%
    Req/Sec   198.00     75.30   460.00     73.71%
  Latency Distribution
     50%  290.85ms
     75%  374.50ms
     90%  459.27ms
     99%  610.12ms
  4602 requests in 3.02s, 350.54KB read
Requests/sec:   1521.66
Transfer/sec:    115.91KB
[run.sh] Speed is 1521.66, duration is 49
[run.sh] Fix the request number.
[run.sh] Running the actual test
[run.sh] /wrk/wrk --timeout 20s -t8 -c512 -d49s -s /wrk/fix_req_n.lua -L http://localhost:3000
[run.sh] Checking the resource usage
NAME                             CPU(cores)   MEMORY(bytes)   
castinfo-b9d7f87c-gwggt          1m           104Mi           
composereview-645d44d577-zrm45   1m           2Mi             
frontend-74f96d9f98-c5svn        6m           3Mi             
movieid-74868df96c-72xvz         7m           184Mi           
movieinfo-67b7ffc985-rbm9v       7m           188Mi           
moviereviews-54b4dbfd6-dwdbk     7m           2Mi             
page-5849776c6d-2g79k            7m           2Mi             
plot-56d6fb9dd-shfpw             7m           254Mi           
reviewstorage-5d4f557649-vcltj   8m           3Mi             
ubuntu-client-76886f6bbd-wbt75   0m           0Mi             
uniqueid-6966dd5cc5-669qx        1m           2Mi             
user-755957cdfd-5v4nw            1m           3Mi             
userreviews-768dc858bf-j4hkp     1m           3Mi             
Running 49s test @ http://localhost:3000
  8 threads and 512 connections
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency   473.37ms  685.25ms   5.77s    93.43%
    Req/Sec   208.13     72.30   454.00     68.19%
  Latency Distribution
     50%  324.40ms
     75%  419.53ms
     90%  561.34ms
     99%    3.92s 
  50000 requests in 49.00s, 3.72MB read
Requests/sec:   1020.40
Transfer/sec:     77.73KB
------------------------------
stop time: 33.915145
stop time: 33.826169
stop time: 33.916268
stop time: 33.745750
stop time: 33.984198
stop time: 33.799519
stop time: 33.834032
stop time: 33.835918
[run.sh] Test finished with status 0


50000 / ( ( 33.915145 + 33.826169 + 33.916268 + 33.745750 + 33.984198 + 33.799519 + 33.834032 + 33.835918 ) / 8 ) = 1,476.7940332973