benchmark                        : social
num_threads                      : 8
num_conns                        : 512
target_service                   : hometimeline
request_type                     : mix
repetitions                      : 3
target_num_exp                   : 10
pre_run                          : False
num_req                          : 20000
groundtruths                     : []
slowdowns                        : []
predicteds                       : []
errs                             : []
poker_batch_req                  : 100
client_cpu_quota                 : 4
random_seed                      : 1234
request_ratio                    : {'composepost': 0.09979209979, 'hometimeline': 0.7005428505, 'poststorage': 0.9497747748, 'socialgraph': 0.09979209979, 'usertimeline': 0.4022002772}
baseline_service_processing_time : {'composepost': 0, 'hometimeline': 1000, 'poststorage': 0, 'socialgraph': 0, 'usertimeline': 0}
cpu_quota                        : {'composepost': 2, 'hometimeline': 2, 'poststorage': 2, 'socialgraph': 2, 'usertimeline': 2}
target_processing_time_range     : [0, 1000]
baseline_throughputs             : []
poker_batch                      : 20000000
[test.py] Starting experiment...
[test.py] >>>>>>>>>>>>>>>>>>>>>>>>>>>>> Running experiment 0...
[test.py] Actual processing time range: [0, 100, 200, 300, 400, 500, 600, 700, 800, 900]
[test.py] Running baseline experiment
    [exp] Running (pre_run: False) workload social/mix request with the following configuration: {'CLIENT_CPU_QUOTA': '4', 'SLOWPOKE_POKER_BATCH_THRESHOLD': '20000000', 'SLOWPOKE_PROCESSING_MICROS_COMPOSEPOST': '0', 'SLOWPOKE_PROCESSING_MICROS_HOMETIMELINE': '1000', 'SLOWPOKE_PROCESSING_MICROS_POSTSTORAGE': '0', 'SLOWPOKE_PROCESSING_MICROS_SOCIALGRAPH': '0', 'SLOWPOKE_PROCESSING_MICROS_USERTIMELINE': '0', 'SLOWPOKE_DELAY_MICROS_COMPOSEPOST': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_COMPOSEPOST': '100', 'SLOWPOKE_IS_TARGET_SERVICE_COMPOSEPOST': 'false', 'SLOWPOKE_DELAY_MICROS_HOMETIMELINE': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_HOMETIMELINE': '100', 'SLOWPOKE_IS_TARGET_SERVICE_HOMETIMELINE': 'true', 'SLOWPOKE_DELAY_MICROS_POSTSTORAGE': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_POSTSTORAGE': '100', 'SLOWPOKE_IS_TARGET_SERVICE_POSTSTORAGE': 'false', 'SLOWPOKE_DELAY_MICROS_SOCIALGRAPH': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_SOCIALGRAPH': '100', 'SLOWPOKE_IS_TARGET_SERVICE_SOCIALGRAPH': 'false', 'SLOWPOKE_DELAY_MICROS_USERTIMELINE': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_USERTIMELINE': '100', 'SLOWPOKE_IS_TARGET_SERVICE_USERTIMELINE': 'false'}
    [exp] Executing cmd `bash run.sh social mix 8 512 20000`:
        [run.sh] Running benchmark social with request mix, thread 8, conn 512, duration 60
        [run.sh] Deleting all services
        [run.sh] Waiting for all pods to be deleted
        [run.sh] Deploying all services
        service/composepost created
        deployment.apps/composepost created
        service/hometimeline created
        deployment.apps/hometimeline created
        service/poststorage created
        deployment.apps/poststorage created
        service/socialgraph created
        deployment.apps/socialgraph created
        service/usertimeline created
        deployment.apps/usertimeline created
        [run.sh] Client pod not found, deploying client
        deployment.apps/ubuntu-client created
        [run.sh] Waiting for all pods to be running
        [run.sh] All pods are running
        [run.sh] Checking heartbeat for all services
        [run.sh] All pods can connect to all services
        [run.sh] Populating social benchmark
        Parsing social graph file: ./data/socfb-Reed98.mtx... DONE!
        Analyzing social graph in: ./data/analysis.txt... DONE!
        Populating social graph...
        DONE!
        [run.sh] Copying social/analysis.txt to ubuntu-client-76886f6bbd-xlc5j:/analysis.txt
        [run.sh] Finished populating social
        [run.sh] Starting the rust proxy first for social
        [2m2025-04-09T05:29:31.470349Z[0m [32m INFO[0m [2mproxy::social[0m[2m:[0m Reading social graph from /analysis.txt
        [run.sh] Running warmup test
        [run.sh] /wrk/wrk -t8 -c512 --timeout 3s -d3s -L http://localhost:3000
        Running 3s test @ http://localhost:3000
        8 threads and 512 connections
        Thread Stats   Avg      Stdev     Max   +/- Stdev
        Latency   308.90ms  282.55ms   1.29s    53.03%
        Req/Sec   181.36     91.40   606.00     72.92%
        Latency Distribution
        50%  304.47ms
        75%  517.55ms
        90%  681.98ms
        99%  956.87ms
        4335 requests in 3.02s, 330.21KB read
        Requests/sec:   1434.45
        Transfer/sec:    109.26KB
        [run.sh] Speed is 1434.45, duration is 20
        [run.sh] Fix the request number.
        [run.sh] Running the actual test
        [run.sh] /wrk/wrk --timeout 20s -t8 -c512 -d20s -s /wrk/fix_req_n.lua -L http://localhost:3000
        Running 20s test @ http://localhost:3000
        8 threads and 512 connections
        Thread Stats   Avg      Stdev     Max   +/- Stdev
        Latency   343.31ms  319.90ms   1.98s    54.15%
        Req/Sec   189.30     90.35   737.00     69.22%
        Latency Distribution
        50%  383.59ms
        75%  550.97ms
        90%  740.65ms
        99%    1.24s
        20000 requests in 20.00s, 1.49MB read
        Requests/sec:    999.99
        Transfer/sec:     76.17KB
        ------------------------------
        stop time: 13.399636
        stop time: 13.056020
        stop time: 12.881060
        stop time: 13.451142
        stop time: 13.339361
        stop time: 13.549990
        stop time: 13.140415
        stop time: 13.226324
        [run.sh] Checking the resource usage
        NAME                             CPU(cores)   MEMORY(bytes)
        composepost-7b4b6d79dd-rkqnr     72m          15Mi
        hometimeline-5b75f5789f-tvb85    239m         49Mi
        poststorage-6f7cf87dc5-299rw     98m          23Mi
        socialgraph-7885949c4-klpr5      5m           11Mi
        ubuntu-client-76886f6bbd-xlc5j   128m         54Mi
        usertimeline-647cdc4d75-tlf6q    73m          13Mi
        [run.sh] Test finished with status 0
        > STDERR
        > No resources found in default namespace.
        > error: no objects passed to apply
    [exp] Times: [13.399636, 13.05602, 12.88106, 13.451142, 13.339361, 13.54999, 13.140415, 13.226324]
    [exp] Throughput: 1508.8084046059846
[test.py] Baseline throughput: 1508.8084046059846
[test.py] Running 0th optmization experiment
[test.py] Running 0th groundtruth exp
    [exp] Running (pre_run: False) workload social/mix request with the following configuration: {'CLIENT_CPU_QUOTA': '4', 'SLOWPOKE_POKER_BATCH_THRESHOLD': '20000000', 'SLOWPOKE_PROCESSING_MICROS_COMPOSEPOST': '0', 'SLOWPOKE_PROCESSING_MICROS_HOMETIMELINE': '0', 'SLOWPOKE_PROCESSING_MICROS_POSTSTORAGE': '0', 'SLOWPOKE_PROCESSING_MICROS_SOCIALGRAPH': '0', 'SLOWPOKE_PROCESSING_MICROS_USERTIMELINE': '0', 'SLOWPOKE_DELAY_MICROS_COMPOSEPOST': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_COMPOSEPOST': '100', 'SLOWPOKE_IS_TARGET_SERVICE_COMPOSEPOST': 'false', 'SLOWPOKE_DELAY_MICROS_HOMETIMELINE': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_HOMETIMELINE': '100', 'SLOWPOKE_IS_TARGET_SERVICE_HOMETIMELINE': 'true', 'SLOWPOKE_DELAY_MICROS_POSTSTORAGE': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_POSTSTORAGE': '100', 'SLOWPOKE_IS_TARGET_SERVICE_POSTSTORAGE': 'false', 'SLOWPOKE_DELAY_MICROS_SOCIALGRAPH': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_SOCIALGRAPH': '100', 'SLOWPOKE_IS_TARGET_SERVICE_SOCIALGRAPH': 'false', 'SLOWPOKE_DELAY_MICROS_USERTIMELINE': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_USERTIMELINE': '100', 'SLOWPOKE_IS_TARGET_SERVICE_USERTIMELINE': 'false'}
    [exp] Executing cmd `bash run.sh social mix 8 512 20000`:
        [run.sh] Running benchmark social with request mix, thread 8, conn 512, duration 60
        [run.sh] Deleting all services
        service "composepost" deleted
        deployment.apps "composepost" deleted
        service "hometimeline" deleted
        deployment.apps "hometimeline" deleted
        service "poststorage" deleted
        deployment.apps "poststorage" deleted
        service "socialgraph" deleted
        deployment.apps "socialgraph" deleted
        service "usertimeline" deleted
        deployment.apps "usertimeline" deleted
        deployment.apps "ubuntu-client" deleted
        [run.sh] Waiting for all pods to be deleted
        [run.sh] Deploying all services
        service/composepost created
        deployment.apps/composepost created
        service/hometimeline created
        deployment.apps/hometimeline created
        service/poststorage created
        deployment.apps/poststorage created
        service/socialgraph created
        deployment.apps/socialgraph created
        service/usertimeline created
        deployment.apps/usertimeline created
        [run.sh] Client pod not found, deploying client
        deployment.apps/ubuntu-client created
        [run.sh] Waiting for all pods to be running
        [run.sh] All pods are running
        [run.sh] Checking heartbeat for all services
        [run.sh] All pods can connect to all services
        [run.sh] Populating social benchmark
        Parsing social graph file: ./data/socfb-Reed98.mtx... DONE!
        Analyzing social graph in: ./data/analysis.txt... DONE!
        Populating social graph...
        DONE!
        [run.sh] Copying social/analysis.txt to ubuntu-client-76886f6bbd-4zfl8:/analysis.txt
        [run.sh] Finished populating social
        [run.sh] Starting the rust proxy first for social
        [2m2025-04-09T05:31:05.291181Z[0m [32m INFO[0m [2mproxy::social[0m[2m:[0m Reading social graph from /analysis.txt
        [run.sh] Running warmup test
        [run.sh] /wrk/wrk -t8 -c512 --timeout 3s -d3s -L http://localhost:3000
        Running 3s test @ http://localhost:3000
        8 threads and 512 connections
        Thread Stats   Avg      Stdev     Max   +/- Stdev
        Latency   156.12ms  132.08ms 658.48ms   49.36%
        Req/Sec   375.82     93.28   770.00     71.67%
        Latency Distribution
        50%  185.57ms
        75%  270.35ms
        90%  318.01ms
        99%  432.74ms
        8988 requests in 3.03s, 684.63KB read
        Requests/sec:   2969.58
        Transfer/sec:    226.20KB
        [run.sh] Speed is 2969.58, duration is 10
        [run.sh] Fix the request number.
        [run.sh] Running the actual test
        [run.sh] /wrk/wrk --timeout 20s -t8 -c512 -d10s -s /wrk/fix_req_n.lua -L http://localhost:3000
        Running 10s test @ http://localhost:3000
        8 threads and 512 connections
        Thread Stats   Avg      Stdev     Max   +/- Stdev
        Latency   165.80ms  141.83ms 638.77ms   48.94%
        Req/Sec   380.04     92.66     0.92k    72.55%
        Latency Distribution
        50%  224.93ms
        75%  287.57ms
        90%  330.98ms
        99%  428.21ms
        20000 requests in 10.00s, 1.49MB read
        Requests/sec:   1999.97
        Transfer/sec:    152.34KB
        ------------------------------
        stop time: 6.406685
        stop time: 6.415007
        stop time: 6.726677
        stop time: 6.580222
        stop time: 6.697168
        stop time: 6.499163
        stop time: 6.699729
        stop time: 6.785195
        [run.sh] Checking the resource usage
        NAME                             CPU(cores)   MEMORY(bytes)
        composepost-7b4b6d79dd-2qxqz     0m           9Mi
        hometimeline-6665bb4554-w7rzc    0m           46Mi
        poststorage-6f7cf87dc5-9x87v     0m           25Mi
        socialgraph-7885949c4-dxd4f      0m           11Mi
        ubuntu-client-76886f6bbd-4zfl8   3m           41Mi
        usertimeline-647cdc4d75-nnx2s    0m           12Mi
        [run.sh] Test finished with status 0
        > STDERR
        > No resources found in default namespace.
        > error: no objects passed to apply
    [exp] Times: [6.406685, 6.415007, 6.726677, 6.580222, 6.697168, 6.499163, 6.699729, 6.785195]
    [exp] Throughput: 3029.738053013826
[test.py] Running 0th slowdown exp
    [exp] Running (pre_run: False) workload social/mix request with the following configuration: {'CLIENT_CPU_QUOTA': '4', 'SLOWPOKE_POKER_BATCH_THRESHOLD': '20000000', 'SLOWPOKE_PROCESSING_MICROS_COMPOSEPOST': '0', 'SLOWPOKE_PROCESSING_MICROS_HOMETIMELINE': '1000', 'SLOWPOKE_PROCESSING_MICROS_POSTSTORAGE': '0', 'SLOWPOKE_PROCESSING_MICROS_SOCIALGRAPH': '0', 'SLOWPOKE_PROCESSING_MICROS_USERTIMELINE': '0', 'SLOWPOKE_DELAY_MICROS_COMPOSEPOST': '3510.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_COMPOSEPOST': '100', 'SLOWPOKE_IS_TARGET_SERVICE_COMPOSEPOST': 'false', 'SLOWPOKE_DELAY_MICROS_HOMETIMELINE': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_HOMETIMELINE': '100', 'SLOWPOKE_IS_TARGET_SERVICE_HOMETIMELINE': 'true', 'SLOWPOKE_DELAY_MICROS_POSTSTORAGE': '368.5', 'SLOWPOKE_POKER_BATCH_THRESHOLD_POSTSTORAGE': '100', 'SLOWPOKE_IS_TARGET_SERVICE_POSTSTORAGE': 'false', 'SLOWPOKE_DELAY_MICROS_SOCIALGRAPH': '3510.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_SOCIALGRAPH': '100', 'SLOWPOKE_IS_TARGET_SERVICE_SOCIALGRAPH': 'false', 'SLOWPOKE_DELAY_MICROS_USERTIMELINE': '870.5', 'SLOWPOKE_POKER_BATCH_THRESHOLD_USERTIMELINE': '100', 'SLOWPOKE_IS_TARGET_SERVICE_USERTIMELINE': 'false'}
    [exp] Executing cmd `bash run.sh social mix 8 512 20000`:
        [run.sh] Running benchmark social with request mix, thread 8, conn 512, duration 60
        [run.sh] Deleting all services
        service "composepost" deleted
        deployment.apps "composepost" deleted
        service "hometimeline" deleted
        deployment.apps "hometimeline" deleted
        service "poststorage" deleted
        deployment.apps "poststorage" deleted
        service "socialgraph" deleted
        deployment.apps "socialgraph" deleted
        service "usertimeline" deleted
        deployment.apps "usertimeline" deleted
        deployment.apps "ubuntu-client" deleted
        [run.sh] Waiting for all pods to be deleted
        [run.sh] Deploying all services
        service/composepost created
        deployment.apps/composepost created
        service/hometimeline created
        deployment.apps/hometimeline created
        service/poststorage created
        deployment.apps/poststorage created
        service/socialgraph created
        deployment.apps/socialgraph created
        service/usertimeline created
        deployment.apps/usertimeline created
        [run.sh] Client pod not found, deploying client
        deployment.apps/ubuntu-client created
        [run.sh] Waiting for all pods to be running
        [run.sh] All pods are running
        [run.sh] Checking heartbeat for all services
        [run.sh] All pods can connect to all services
        [run.sh] Populating social benchmark
        Parsing social graph file: ./data/socfb-Reed98.mtx... DONE!
        Analyzing social graph in: ./data/analysis.txt... DONE!
        Populating social graph...
        DONE!
        [run.sh] Copying social/analysis.txt to ubuntu-client-76886f6bbd-pgn7q:/analysis.txt
        [run.sh] Finished populating social
        [run.sh] Starting the rust proxy first for social
        [2m2025-04-09T05:32:46.447098Z[0m [32m INFO[0m [2mproxy::social[0m[2m:[0m Reading social graph from /analysis.txt
        [run.sh] Running warmup test
        [run.sh] /wrk/wrk -t8 -c512 --timeout 3s -d3s -L http://localhost:3000
        Running 3s test @ http://localhost:3000
        8 threads and 512 connections
        Thread Stats   Avg      Stdev     Max   +/- Stdev
        Latency   306.96ms  255.96ms 993.67ms   49.23%
        Req/Sec   173.55     73.13   390.00     66.81%
        Latency Distribution
        50%  276.02ms
        75%  549.79ms
        90%  637.21ms
        99%  808.74ms
        4123 requests in 3.02s, 314.06KB read
        Requests/sec:   1367.19
        Transfer/sec:    104.14KB
        [run.sh] Speed is 1367.19, duration is 21
        [run.sh] Fix the request number.
        [run.sh] Running the actual test
        [run.sh] /wrk/wrk --timeout 20s -t8 -c512 -d21s -s /wrk/fix_req_n.lua -L http://localhost:3000
        Running 21s test @ http://localhost:3000
        8 threads and 512 connections
        Thread Stats   Avg      Stdev     Max   +/- Stdev
        Latency   354.90ms  281.88ms   1.09s    49.92%
        Req/Sec   177.94     65.85   420.00     67.94%
        Latency Distribution
        50%  509.68ms
        75%  604.93ms
        90%  667.57ms
        99%  788.34ms
        20000 requests in 21.00s, 1.49MB read
        Requests/sec:    952.37
        Transfer/sec:     72.54KB
        ------------------------------
        stop time: 14.057640
        stop time: 14.141107
        stop time: 14.342496
        stop time: 14.097293
        stop time: 14.276033
        stop time: 14.118230
        stop time: 13.857424
        stop time: 14.130701
        [run.sh] Checking the resource usage
        NAME                             CPU(cores)   MEMORY(bytes)
        composepost-676c8b7677-2bqsd     98m          10Mi
        hometimeline-5b75f5789f-fk6k8    50m          14Mi
        poststorage-87668cf95-8k27x      22m          13Mi
        socialgraph-57b986797c-dkbm9     22m          11Mi
        ubuntu-client-76886f6bbd-pgn7q   1m           1Mi
        usertimeline-747d4cdf7f-h9jtj    24m          8Mi
        [run.sh] Test finished with status 0
        > STDERR
        > No resources found in default namespace.
        > error: no objects passed to apply
    [exp] Times: [14.05764, 14.141107, 14.342496, 14.097293, 14.276033, 14.11823, 13.857424, 14.130701]
    [exp] Throughput: 1415.667067099894
[test.py] Finished running 0th optmization experiment: groundtruth->3029.738053013826, slowdown->1415.667067099894, predicted->2808.1262137656076, err->-7.314554439046986
[test.py] Running 1th optmization experiment
[test.py] Running 1th groundtruth exp
    [exp] Running (pre_run: False) workload social/mix request with the following configuration: {'CLIENT_CPU_QUOTA': '4', 'SLOWPOKE_POKER_BATCH_THRESHOLD': '20000000', 'SLOWPOKE_PROCESSING_MICROS_COMPOSEPOST': '0', 'SLOWPOKE_PROCESSING_MICROS_HOMETIMELINE': '100', 'SLOWPOKE_PROCESSING_MICROS_POSTSTORAGE': '0', 'SLOWPOKE_PROCESSING_MICROS_SOCIALGRAPH': '0', 'SLOWPOKE_PROCESSING_MICROS_USERTIMELINE': '0', 'SLOWPOKE_DELAY_MICROS_COMPOSEPOST': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_COMPOSEPOST': '100', 'SLOWPOKE_IS_TARGET_SERVICE_COMPOSEPOST': 'false', 'SLOWPOKE_DELAY_MICROS_HOMETIMELINE': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_HOMETIMELINE': '100', 'SLOWPOKE_IS_TARGET_SERVICE_HOMETIMELINE': 'true', 'SLOWPOKE_DELAY_MICROS_POSTSTORAGE': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_POSTSTORAGE': '100', 'SLOWPOKE_IS_TARGET_SERVICE_POSTSTORAGE': 'false', 'SLOWPOKE_DELAY_MICROS_SOCIALGRAPH': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_SOCIALGRAPH': '100', 'SLOWPOKE_IS_TARGET_SERVICE_SOCIALGRAPH': 'false', 'SLOWPOKE_DELAY_MICROS_USERTIMELINE': '0.0', 'SLOWPOKE_POKER_BATCH_THRESHOLD_USERTIMELINE': '100', 'SLOWPOKE_IS_TARGET_SERVICE_USERTIMELINE': 'false'}
    [exp] Executing cmd `bash run.sh social mix 8 512 20000`:
        [run.sh] Running benchmark social with request mix, thread 8, conn 512, duration 60
        [run.sh] Deleting all services
        service "composepost" deleted
        deployment.apps "composepost" deleted
        service "hometimeline" deleted
        deployment.apps "hometimeline" deleted
        service "poststorage" deleted
        deployment.apps "poststorage" deleted
        service "socialgraph" deleted
        deployment.apps "socialgraph" deleted
        service "usertimeline" deleted
        deployment.apps "usertimeline" deleted
        deployment.apps "ubuntu-client" deleted
        [run.sh] Waiting for all pods to be deleted
